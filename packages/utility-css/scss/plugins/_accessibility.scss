//
// Copyright IBM Corp. 2018, 2018
//
// This source code is licensed under the Apache-2.0 license found in the
// LICENSE file in the root directory of this source tree.
//

@use 'sass:map';
@use '../rules';
@use '../pseudo-class';

$default-enabled: true;
$default-options: (
  active: false,
  hover: false,
  focus: true,
  disabled: false,
  responsive: true,
);

@function plugin($theme, $rules, $options) {
  $keys: ();

  @if map.get($options, responsive) == true {
    $keys: map.keys($rules);
  } @else {
    $keys: (defaults);
  }

  $plugin-rules: (
    (
      declaration: 'sr-only',
      properties: (
        position: absolute,
        width: 1px,
        height: 1px,
        padding: 0,
        margin: -1px,
        overflow: hidden,
        clip: rect(0, 0, 0, 0),
        white-space: nowrap,
        border-width: 0,
      ),
    ),
    (
      declaration: 'not-sr-only',
      properties: (
        position: static,
        width: auto,
        height: auto,
        padding: 0,
        margin: 0,
        overflow: visible,
        clip: auto,
        white-space: normal,
      ),
    )
  );

  @each $rule in $plugin-rules {
    $rules: rules.add($rules, $keys, $rule);
    @if map.get($options, hover) == true {
      $rules: rules.add($rules, $keys, pseudo-class.hover($rule));
    }
    @if map.get($options, focus) == true {
      $rules: rules.add($rules, $keys, pseudo-class.focus($rule));
    }
    @if map.get($options, active) == true {
      $rules: rules.add($rules, $keys, pseudo-class.active($rule));
    }
  }

  @return $rules;
}
